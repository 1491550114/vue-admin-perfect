import{d as P}from"./index.5be08a55.js";import{g as Y,i as D,x as G,O as H,r as s,o,c as r,b as a,w as l,d as n,q as O,F as v,D as S,n as y,t as V,J as Q,a as B,s as L,_ as I,M as N}from"./index.8ab1f836.js";const R={class:"m-edit-table"},X={key:0,style:{"margin-top":"15px","margin-bottom":"15px"}},Z={key:1},ee={key:1},te={key:1},le={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},ue={style:{"text-align":"right",margin:"0"}},ae={key:1,style:{"margin-top":"15px"}},oe=Y({__name:"index",props:{columns:{type:Array,default:()=>[]},data:{type:Array,default:()=>[]},editableKeys:{type:Array,default:()=>[]},mode:{type:String,default:"bottom"}},emits:["del","add","onChange"],setup(F,{expose:A,emit:w}){const c=F;let _=D([]);const g=e=>{},h=()=>{let e=P(_.value);for(let u of e)for(let i in u)i.includes("te__mp")&&delete u[i];w("onChange",e)};let C={};for(let e of c.columns)c.data.forEach(u=>{C[e.name]||(C[e.name]=null)});const k=()=>{_.value=c.data;for(let e of _.value)c.editableKeys.includes(e.id)&&(e.edit=!0);h()};G(()=>{H(()=>c.data,e=>{_.value=P(e);for(let u of _.value){c.editableKeys.includes(u.id)&&(u.edit=!0);for(let i in u){let p=`${i}te__mp`;u[p]=u[i]}}},{immediate:!0,deep:!0})}),D(!1),D(!1);const $=e=>{e.edit=!1;for(let u in e)u.includes("te__mp")&&(e[u]=e[u.replace("te__mp","")]);h()},U=e=>{e.edit=!e.edit;for(let u in e)u!=="edit"&&(u.includes("te__mp")||(e[u]=e[u+"te__mp"]))},K=e=>{e.visible=!1,_.value=_.value.filter(u=>u.id!==e.id),w("del",e)},x=()=>{let e=~~(Math.random()*1e6).toFixed(0),u=Object.assign({},C,{id:e,edit:!0,visible:!1});for(let i in u){let p=`${i}te__mp`;u[p]=u[i]}c.mode==="bottom"&&_.value.push(u),c.mode==="top"&&_.value.unshift(u)},T=(e,u)=>{let i=e.options.find(p=>p.value===u.row[e.name]);return i?i.label:"--"};return A({reset:k}),(e,u)=>{const i=s("plus"),p=s("el-icon"),m=s("el-button"),E=s("el-table-column"),f=s("el-option"),j=s("el-select"),z=s("el-date-picker"),M=s("el-input"),W=s("warning-filled"),q=s("el-popover"),J=s("el-table");return o(),r("div",R,[F.mode!=="hide"&&F.mode!=="bottom"?(o(),r("div",X,[a(m,{style:{width:"100%"},onClick:x},{default:l(()=>[a(p,{style:{"margin-right":"4px"}},{default:l(()=>[a(i)]),_:1}),n(" \u6DFB\u52A0\u4E00\u884C\u6570\u636E")]),_:1})])):O("",!0),a(J,{data:L(_),style:{width:"100%"},"row-key":"id",border:""},{default:l(()=>[(o(!0),r(v,null,S(F.columns,t=>(o(),r(v,null,[t.type?(o(),y(E,{key:0,type:t.type,width:t.width,align:t.align,fixed:t.fixed,label:t.label},null,8,["type","width","align","fixed","label"])):(o(),y(E,{key:1,prop:t.name,width:t.width,align:t.align,fixed:t.fixed,label:t.label},{default:l(d=>[t.slot?Q(e.$slots,t.name,{key:1,item:t,row:d.row},void 0,!0):(o(),r(v,{key:0},[t.readonly?(o(),r(v,{key:0},[n(V(d.row[t.name]),1)],64)):t.valueType==="select"?(o(),r(v,{key:1},[d.row.edit?(o(),y(j,{key:0,clearable:"",placeholder:"\u8BF7\u9009\u62E9",modelValue:d.row[t.name],"onUpdate:modelValue":b=>d.row[t.name]=b},{default:l(()=>[(o(!0),r(v,null,S(t.options,b=>(o(),y(f,{key:b.value,label:b.label,value:b.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r("span",Z,V(T(t,d)),1))],64)):t.valueType==="date"?(o(),r(v,{key:2},[d.row.edit?(o(),y(z,{key:0,modelValue:d.row[t.name],"onUpdate:modelValue":b=>d.row[t.name]=b,type:"date","value-format":"YYYY-MM-DD",clearable:"",placeholder:"\u8BF7\u9009\u62E9"},null,8,["modelValue","onUpdate:modelValue"])):(o(),r("span",ee,V(d.row[t.name]||"--"),1))],64)):(o(),r(v,{key:3},[d.row.edit?(o(),y(M,{key:0,clearable:"",placeholder:"\u8BF7\u8F93\u5165",modelValue:d.row[t.name],"onUpdate:modelValue":b=>d.row[t.name]=b},null,8,["modelValue","onUpdate:modelValue"])):(o(),r("span",te,V(d.row[t.name]||"--"),1))],64))],64))]),_:2},1032,["prop","width","align","fixed","label"]))],64))),256)),a(E,{prop:"operator",label:"\u64CD\u4F5C",width:"250px",fixed:"right"},{default:l(t=>[t.row.edit?(o(),y(m,{key:0,type:"primary",size:"small",icon:"CircleCheckFilled",onClick:d=>$(t.row)},{default:l(()=>[n(" \u4FDD\u5B58 ")]),_:2},1032,["onClick"])):(o(),y(m,{key:1,type:"primary",size:"small",icon:"Edit",onClick:d=>t.row.edit=!t.row.edit},{default:l(()=>[n(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),a(q,{trigger:"click",visible:t.row.visible,"onUpdate:visible":d=>t.row.visible=d,placement:"top",width:160},{reference:l(()=>[a(m,{icon:"Delete",onClick:d=>g(t.row),type:"danger",size:"small"},{default:l(()=>[n("\u5220\u9664")]),_:2},1032,["onClick"])]),default:l(()=>[B("p",le,[a(p,{color:"#faad14",style:{"margin-right":"10px"}},{default:l(()=>[a(W)]),_:1}),n(" \u5220\u9664\u6B64\u884C\uFF1F")]),B("div",ue,[a(m,{size:"small",onClick:d=>t.row.visible=!1},{default:l(()=>[n("\u53D6\u6D88")]),_:2},1032,["onClick"]),a(m,{size:"small",type:"primary",onClick:d=>K(t.row)},{default:l(()=>[n("\u786E\u5B9A")]),_:2},1032,["onClick"])])]),_:2},1032,["visible","onUpdate:visible"]),t.row.edit?(o(),y(m,{key:2,type:"primary",size:"small",icon:"Edit",onClick:d=>U(t.row)},{default:l(()=>[n(" \u53D6\u6D88 ")]),_:2},1032,["onClick"])):O("",!0)]),_:1})]),_:3},8,["data"]),F.mode!=="hide"&&F.mode!=="top"?(o(),r("div",ae,[a(m,{style:{width:"100%"},onClick:x},{default:l(()=>[a(p,{style:{"margin-right":"4px"}},{default:l(()=>[a(i)]),_:1}),n(" \u6DFB\u52A0\u4E00\u884C\u6570\u636E")]),_:1})])):O("",!0)])}}});const ne=I(oe,[["__scopeId","data-v-df54fc83"]]),de={style:{"margin-bottom":"20px"}},ie={style:{display:"flex","justify-content":"flex-end"}},se={style:{"margin-top":"20px"}},re=Y({__name:"index",setup(F){const A=D(),w=[{name:"title",label:"\u6D3B\u52A8\u540D\u79F0",width:160},{name:"state",label:"\u72B6\u6001",options:[{value:-1,label:"\u5168\u90E8"},{value:1,label:"\u672A\u89E3\u51B3"},{value:0,label:"\u5DF2\u89E3\u51B3"}],valueType:"select"},{name:"decs",label:"\u63CF\u8FF0",valueType:"input"},{name:"created_at",label:"\u6D3B\u52A8\u65F6\u95F4",valueType:"date"}];let c=[{id:6247418504,title:"\u6D3B\u52A8\u540D\u79F0\u4E00",readonly:"\u6D3B\u52A8\u540D\u79F0\u4E00",decs:"\u8FD9\u4E2A\u6D3B\u52A8\u771F\u597D\u73A9",state:1,created_at:"2020-05-26",update_at:"2020-05-26"},{id:6246921229,title:"\u6D3B\u52A8\u540D\u79F0\u4E8C",readonly:"\u6D3B\u52A8\u540D\u79F0\u4E8C",decs:"\u8FD9\u4E2A\u6D3B\u52A8\u771F\u597D\u73A9",state:0,created_at:"2020-05-26",update_at:"2020-05-26"},{id:6242991229,title:"\u6D3B\u52A8\u540D\u79F0\u4E09",readonly:"\u6D3B\u52A8\u540D\u79F0\u4E09",decs:"\u8FD9\u4E2A\u6D3B\u52A8\u771F\u597D\u73A9",state:1,created_at:"2020-05-26",update_at:"2020-05-26"},{id:6242981229,title:"\u6D3B\u52A8\u540D\u79F0\u56DB",readonly:"\u6D3B\u52A8\u540D\u79F0\u56DB",decs:"\u8FD9\u4E2A\u6D3B\u52A8\u771F\u597D\u73A9",state:1,created_at:"2020-05-26",update_at:"2020-05-26"}],_=c.map(e=>e.id).filter(e=>![6247418504,6246921229].includes(e));const g=D("bottom"),h=D(c);let C=D(_);const k=D(c),$=e=>{console.log("\u5220\u9664",e),N.success("\u70B9\u51FB\u5220\u9664")},U=e=>{k.value=e},K=e=>{},x=e=>{N.success("\u91CD\u7F6E\u6210\u529F"),A.value.reset()},T=()=>{h.value=k.value,console.log("\u70B9\u51FB\u63D0\u4EA4=========",k.value),N.success("\u70B9\u51FB\u63D0\u4EA4\u6570\u636E")};return(e,u)=>{const i=s("el-radio"),p=s("el-radio-group"),m=s("el-divider"),E=s("el-button"),f=s("el-descriptions-item"),j=s("el-descriptions"),z=s("PageWrapLayout");return o(),y(z,null,{default:l(()=>[B("div",de,[B("div",ie,[a(p,{modelValue:g.value,"onUpdate:modelValue":u[0]||(u[0]=M=>g.value=M)},{default:l(()=>[a(i,{label:"top"},{default:l(()=>[n("\u6DFB\u52A0\u5230\u9876\u90E8")]),_:1}),a(i,{label:"bottom"},{default:l(()=>[n("\u6DFB\u52A0\u5230\u5E95\u90E8")]),_:1}),a(i,{label:"hide"},{default:l(()=>[n("\u9690\u85CF")]),_:1})]),_:1},8,["modelValue"])]),a(m),a(ne,{mode:g.value,columns:w,data:h.value,onAdd:K,ref_key:"table",ref:A,editableKeys:L(C),onOnChange:U,onDel:$},null,8,["mode","data","editableKeys"]),B("div",se,[a(E,{onClick:x},{default:l(()=>[n("\u91CD\u7F6E")]),_:1}),a(E,{type:"primary",onClick:T},{default:l(()=>[n("\u63D0\u4EA4")]),_:1})])]),a(j,{title:"\u914D\u7F6E\u9879 ",column:1,border:"",class:"descriptions"},{default:l(()=>[a(f,{label:"\u7EC4\u4EF6\u540D"},{default:l(()=>[n(" EditableProTable ")]),_:1}),a(f,{label:"columns"},{default:l(()=>[n(" \u663E\u793A\u7684\u5217\u6570\u636E ")]),_:1}),a(f,{label:"data"},{default:l(()=>[n(" \u6E90\u6570\u636E ")]),_:1}),a(f,{label:"editableKeys"},{default:l(()=>[n(" \u663E\u793A\u53EF\u7F16\u8F91\u8F93\u5165\u6846\u7684key\u96C6\u5408 ")]),_:1}),a(f,{label:"mode"},{default:l(()=>[n(" \u64CD\u4F5C\u6309\u94AE\u663E\u793A\u7684\u5730\u65B9\uFF0C\u9ED8\u8BA4\u663E\u793A\u5728\u5E95\u90E8'bottom', 'top bottom hide' ")]),_:1}),a(f,{label:"del"},{default:l(()=>[n(" \u5220\u9664\u5F53\u524D\u884C\u89E6\u53D1\u7684\u4E8B\u4EF6 ")]),_:1}),a(f,{label:"add"},{default:l(()=>[n(" \u6DFB\u52A0\u4E00\u884C\u89E6\u53D1\u7684\u4E8B\u4EF6 ")]),_:1}),a(f,{label:"onChange"},{default:l(()=>[n(" \u6570\u636E\u5B9E\u65F6\u6539\u53D8 ")]),_:1})]),_:1})]),_:1})}}});const pe=I(re,[["__scopeId","data-v-11f43697"]]);export{pe as default};
